<!doctype html>
<html dir="ltr" lang="en">
<head>
    <title>onminute - JavaScript for Time Differences and Dates</title>
    <meta name="keywords" content="javascript, time difference, dates, timestamp, js"/>
    <meta name="description" content="a javascript library for in displaying time differences and dates on html pages"/>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>


    <link rel="stylesheet" type="text/css" href="../website/static/css/main.css"/>

    <!--[if lt IE9]
    <script src="//github.com/aFarkas/html5shiv/blob/master/dist/html5shiv.js"></script>
    -->
    <script src="../oneminute.js"></script>


</head>


<body class="cf">
<header><img src="../website/static/imgs/logo-vertical.png"/></header>
<section>
    <aside>
        <div id="cur-time-pace">
            Time is moving at <input type="text" id="seconds-per-second" value="1"> seconds<br>per<br>earth second
        </div>
        <div style="margin: 20px 0">
            You visited this page:
            <div class="visited-timestamp"></div>   <br>
            The date:
            <div class="visited-timestamp" data-time-mode="1"></div>
        </div>

        <div>
            oneminute.js is JavaScript library which converts
            integer timestamps to meaningful text conveying time differences, and/or optionally dates.
        </div>

    </aside>

    <aside>

        <textarea rows="2" id="test-comment" placeholder="Test with comments..."></textarea>
        <ul id="comments-list">
            <li>This comment was left when unix was created (<span data-timestamp="0"></span>)</li>
            <li>The day Elvis Presley was born (<span data-timestamp="-1103932800"></span>)</li>
        </ul>

    </aside>
    <aside>
        <h1>API</h1>
        <pre >
<span class="html-tag">html</span>
  <span class="html-tag">body</span>
    blah blah blah
    <span class="html-tag">span <span class="html-attr">data-timestamp</span><span class="html-val">{timestamp}</span></span><span class="html-tag">/span</span>
    blah blah blah
    <span class="html-tag">span <span class="html-attr">data-timestamp</span><span class="html-val">{timestamp}</span></span><span class="html-tag">/span</span>
    blah blah blah
    <span class="html-tag">span <span class="html-attr">data-timestamp</span><span class="html-val">{timestamp}</span></span><span class="html-tag">/span</span>
    blah blah blah
    <span class="html-tag">script <span class="html-attr">src</span><span class="html-val">oneminute.js</span></span><span class="html-tag">/span</span>
  <span class="html-tag">/body</span>
<span class="html-tag">/html</span>
</pre>

        <div>       <br>
            The above html (with oneminute.js included at the bottom) will result
            in the span
            tags to obtain a text of the textual time difference, for example
            : "2 years ago", "3 hours ago","2 weeks from now", etc.<br>
            Note that span tags were used in the above example however any html tag (eg: div, p, abbr, ...) can be used.
            <br>                                                   <br>
            However besides textual time differences you might want to display the date? or maybe
            even both the textual time difference as well as the date? for that the following
            span
            tag:
            <pre>

<span class="html-tag">span <span class="html-attr">data-timestamp</span><span class="html-val">{timestamp}</span></span><span class="html-tag">/span</span>
            </pre>

            would instead needed to supplied with one more data attribute, which is data-time-mode:
            <pre>

<span class="html-tag">span <span class="html-attr">data-timestamp</span><span class="html-val">{timestamp}</span> <span class="html-attr">data-time-mode</span><span class="html-val">{0/1/2}</span></span><span class="html-tag">/span</span>
            </pre>

            The data-time-mode attribute has 3 possible options:
            <ul>
                <li>0 (by default when the attribute is not specified)<br>
                    This results in the textual time difference between the current local timestamp with the timestamp
                    specified by data-timestamp, example: "1 week ago".
                    The title of the html tag will be set to the date of the timestamp specified by data-timestamp, example: "23 Jan 2012".
                </li>
                <li>1<br>
                    This results in the date of the timestamp specified by data-timestamp, example: "23 Jan 2012".
                </li>
                <li>2<br>
                    This results in a combination of the above textual time difference and data (with respect to the timestamp specified by data-timestamp), where the date comes first and the textual time difference enclosed in parentheses occurs thereafter example: "23 Jan 2012 (one year ago)".
                </li>
            </ul>
            <br>
            The library contains 5 functions, 1 setInterval variable & 1 environment variable:<br>
            The following are the functions
            <ul>
                <li>
                    <pre class="function-par-name">cur_timestamp()</pre>
                    Returns the current integer timestamp of the local computer (browser) in seconds, and not in
                    milliseconds which is JavaScript's default.
                </li>
                <li>
                    <pre class="function-par-name">ts_diff(timestamp)</pre>
                    Returns a string representing the textual difference in time between the current local timestamp
                    and the timestamp given by the parameter <pre>timestamp</pre>. Example: 11 minutes ago.
                </li>
                <li>
                    <pre class="function-par-name">ts_date(timestamp)</pre>
                    Returns a string representing the date of the timestamp <pre>timestamp</pre> (this is what will be
                    returned when one sets data-time-mode to 1). Example: 4 July 1776.
                </li>
                <li>
                    <pre class="function-par-name">gimme_oneminute(timestamp, time_mode)</pre>
                    Returns the following depending on the <pre>time_mode</pre> specified:
                    <ul>
                        <li>0 (by default when the attribute is not specified)<br>
                            This results in the textual time difference between the current local timestamp with the timestamp
                            specified by data-timestamp, example: "1 week ago".
                            The title of the html tag will be set to the date of the timestamp specified by data-timestamp, example: "23 Jan 2012".
                        </li>
                        <li>1<br>
                            This results in the date of the timestamp specified by data-timestamp, example: "23 Jan 2012".
                        </li>
                        <li>2<br>
                            This results in a combination of the above textual time difference and data (with respect to the timestamp specified by data-timestamp), where the date comes first and the textual time difference enclosed in parentheses occurs thereafter example: "23 Jan 2012 (one year ago)".
                        </li>
                    </ul>
                </li>
                <li>
                    <pre class="function-par-name">oneminute()</pre>
                    Loops through the html document find tags (span,div,i,etc.. any tag) which contains <pre>data-timestamp</pre>
                    and optionally <pre>data-time-mode</pre>, and provides the inner html of the tag as dictated by rules of <pre>gimme_oneminute(timestamp, time_mode</pre>, where the value of <pre>data-timestamp</pre> is the parameter <pre>timestamp</pre>, and the value of
                    <pre>data-time-mode</pre> is the parameter <pre>time_mode</pre>. Internally oneminute() (obviously) uses gimme_oneminute().
                </li>
            </ul>
            <br>
            Environment Variable: <pre class="function-par-name">oneminute_interval</pre>
            The value of this variable is a number, and it represents, in milliseconds the time after which <pre>oneminute</pre>
            should (re)scan the html document to update the time differences and/or dates.<br>
            By default this <pre>oneminute_interval</pre> is set to 10 (milliseconds).
            <br><br>
            Interval:
            <pre class="function-par-name">oneminute_rescanner</pre>
            This represents the interval which will prevail every <pre>oneminute_interval</pre> number of milliseconds,
            having a task of using <pre>oneminute</pre> to rescan the document to update the time differences and/or dates.



        </div>
    </aside>

</section>
<a href="https://github.com/relfor/oneminute"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"></a>


<!-- For the sake of the demonstration current timestamp will be determined by us -->
<script>


    var _cur_ts = cur_timestamp();

    var all_elements = document.getElementsByTagName('*');
    var cur_element;
    for (var i = 0; i < all_elements.length; i++) {
        cur_element = all_elements[i];
        if (cur_element.className.indexOf('visited-timestamp') !== -1) {
            cur_element.setAttribute('data-timestamp', _cur_ts);

        }

    }


    clearInterval(oneminute_rescanner);


    var oneminute_rescanner = setInterval(function () {

        _cur_ts += (isNaN(parseInt(document.getElementById('seconds-per-second').value)) ? 0 :
                parseInt(document.getElementById('seconds-per-second').value)
                ) / 100.0;
        oneminute();
    }, oneminute_interval);


</script>
<script>
    function cur_timestamp() {
        return _cur_ts;
    }


    document.getElementById("seconds-per-second").onkeypress = function (e) {
        var key_code = e.keyCode;

        if (!((key_code > 47 && key_code < 58) || key_code === 45 || key_code === 8 || key_code === 37 || key_code === 39)) {
            return false;
        }
    };

    document.getElementById("test-comment").onkeydown = function (e) {
        if (e.keyCode === 13) {
            add_comment(this.value);
            this.value = "";
            return false;
        }
    };

    function add_comment(content) {
        var comments_list = document.getElementById('comments-list');
        comments_list.innerHTML = ("<li>" + content + " (<span data-timestamp='" + cur_timestamp() + "'></span>)</li>") + comments_list.innerHTML;
    }

</script>

</body>

</html>
